---
title: "PS2"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Assignment 2

In contrast to inverse gamma distributions, an inverse Gaussian distribution is **not** the distribution of the reciprocal of a random variable having a Gaussian distribution. It is an entirely different distribution.  

There are any number of ways that people have parameterized inverse Gaussian probability density functions. One way is, for parameters $\mu > 0$ and $\lambda > 0$,

$$
f(y \mid \mu, \lambda) =
\left( \frac{\lambda}{2 \pi y^3} \right)^{1/2}
\exp\left[
-\frac{\lambda}{2 \mu^2 y}(y - \mu)^2
\right], \quad y > 0.
\tag{1}
$$

\newpage

# Question 1 (5 pts)

Write the density (1) in exponential dispersion family form. Identify the natural parameter $\theta$ and dispersion parameter $\phi$ in terms of the original parameters $\mu$ and $\lambda$.

## Answer


\newpage 

# Question 2 (5 pts)

Using the result from question 1, find the expected value and variance of a random variable $Y$ that follows an inverse Gaussian distribution. Write these moments in terms of $\theta$ and $\phi$ and then also in terms of $\mu$ and $\lambda$.  

How is the variance related to the expected value for this distribution?

## Answer


\newpage 

# Question 3 (5 pts)

To get a feel for this distribution with the same location but different values of the dispersion parameter, produce a graph with three overlaid density functions having $\mu = 1$ and $\lambda = 4, 8,$ and $16$.

## Answer

```{r, fig.height=4, fig.width=6}
# Placeholder for your code
# Example: curve plotting densities with dIG from a package

```

\newpage 

# Question 4 (10 pts)

Now compare the inverse Gaussian distributions from Question 3 with the corresponding gamma distributions, which means gamma distributions having the same mean and variance as the inverse Gaussian distributions.  

A gamma density with parameters $\alpha > 0$ and $\beta > 0$ is

$$
f(y \mid \alpha, \beta) =
\frac{\beta^\alpha}{\Gamma(\alpha)}
y^{\alpha - 1} \exp(-\beta y), \quad y > 0.
$$

The expected value and variance for a random variable $Y$ having this distribution are

$$
E(Y) = \frac{\alpha}{\beta}, \quad
\operatorname{Var}(Y) = \frac{\alpha}{\beta^2}.
$$

To find the corresponding gamma distribution for an inverse Gaussian distribution with parameter values $\mu$ and $\lambda$, first determine the expected value and variance that result from your answer to Question 2, equate these with the expected value and variance for a $\text{Gamma}(\alpha, \beta)$ distribution as just given, and solve for $\alpha$ and $\beta$.

Finally, produce three graphs with the three inverse Gaussian distributions already computed in Question 3 and overlay the corresponding gamma distribution.  

For the three cases of Question 3, do you notice any systematic difference in inverse Gaussian and gamma distributions?

## Answer

```{r, fig.height=4, fig.width=6}
# Placeholder code
# Example structure (fill in with actual functions later):

# Define parameters
mu <- 1
lambdas <- c(4, 8, 16)

# Example plotting framework
# for (lambda in lambdas) {
#   # Compute IG density (statmod::dinvgauss)
#   # Compute Gamma density (dgamma with matched mean/var)
#   # Overlay plots
# }
```

*To find the corresponding gamma distribution for an inverse Gaussian distribution with parameter values $\mu$ and $\lambda$, first determine the expected value and variance that result from your answer to Question 2, equate these with the expected value and variance for a $\text{Gamma}(\alpha, \beta)$ distribution as just given, and solve for $\alpha$ and $\beta$.*

*Finally, produce three graphs with the three inverse Gaussian distributions already computed in Question 3 and overlay the corresponding gamma distribution.*

*For the three cases of Question 3, do you notice any systematic difference in inverse Gaussian and gamma distributions?*

