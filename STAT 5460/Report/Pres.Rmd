---
title: "An adaptive test based on Kendall's $\\tau$"
subtitle: "for independence in high dimensions [@Shi2024]"
author: "Sam Olson"
date: ""
output:
  beamer_presentation:
    theme: Madrid
    colortheme: default
    fonttheme: professionalfonts
    slide_level: 1
    incremental: false     # show bullets all at once
    keep_tex: true
bibliography: references.bib   # file must sit next to this .Rmd
header-includes:
  - \usepackage{xurl}          % better URL/DOI wrapping
  - \usepackage{microtype}     % nicer spacing
  - \setbeamertemplate{bibliography item}[text]  % no bullets on refs
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, cache = TRUE)
library(tidyverse)
library(readr)
```

# Synopsis of Paper

- Testing complete (mutual) independence in high-dimensional data ($d \gg n$)
- Known that $L_2$-type statistics have lower power under sparse cases
- Known that $L_\infty$-type statistics have lower power under dense cases
- **Goal:** Develop an adaptive test based on Kendall’s $\tau$ to work well in both situations
- Determine necessary assumptions and the asymptotic null distribution of the proposed statistic
- Assess how well the test does compared to other testing methods
- Results indicate the adaptive test performs well in either dense or sparse cases

# What is Kendall's $\tau$? 

$$
\tau = \frac{(\text{Count of concordant pairs}) - (\text{Count of discordant pairs})}{(\text{Number of pairs})}
$$

-   Any pair of observations $(x_i, y_i)$ and $(x_j, y_j)$, where $i < j$, are said to be *concordant* if the sort order of $(x_i, x_j)$ and $(y_i, y_j)$ agrees.
-   That is, if either both $x_i > x_j$ and $y_i > y_j$ holds or both $x_i < x_j$ and $y_i < y_j$; otherwise they are said to be *discordant*.
-   There are other types of Kendall's $\tau$, e.g., $\tau_a$, $\tau_b$, and $\tau_c$.

# Kendall's $\tau$ in [@Shi2024]

In the paper, Kendall’s $\tau$ between $X_k$ and $X_\ell$ is defined as

$$
\tau_{k\ell}
  = \frac{2}{n(n-1)}
    \sum_{i=2}^n \sum_{j=1}^{i-1}
    \operatorname{sign}(R_{ki}-R_{kj})\,
    \operatorname{sign}(R_{\ell i}-R_{\ell j}),
$$

where $R_{ki}$ and $R_{\ell i}$ are the ranks of $X_k$ and $X_\ell$. 

This is equivalent to the definition given on the prior slide. 

# History of Kendall's $\tau$ and related concepts 

-   **1897** — [@Fechner1897] introduces the *method of signs* for succession-dependence.
-   **1938** — [@Kendall1938] develops the $\tau$ rank correlation coefficient.
-   **1958** — [@Kruskal1958] generalizes Kendall’s ideas into a general nonparametric testing framework.
-   **1958–1990s** — Applied to time series settings for tests of serial dependence. [@ElShaarawi1992; @Hamed2011].
-   **2020-2024** — Used to determine whether two separate processes replicate metrics (application in healthcare “match rate” analysis; personal experience). 
-   **2024** — [@Shi2024], **the focus of this presentation**, develop adaptive high-dimensional independence tests using Kendall’s $\tau$.
-   **2025** — [@Han2025] extend to a broader class of sum-of-powers tests.

<!-- # General Summary {.allowframebreaks} -->

<!-- In *Kollektivmasslehre* [@Fechner1897] created a "precursor" to Kendall’s $\tau$. His method of signs looked for consecutive-dependence in sequences of observations: Assess concordance and discordance using only the signs of differences, not their magnitudes. -->

<!-- Kendall [@Kendall1938] generalized Fechner’s idea by considering all possible pairs of observations, not just consecutive ones. His $\tau$ statistic became the canonical rank correlation coefficient, widely adopted as a nonparametric alternative to Pearson’s correlation. -->

<!-- Kruskal [@Kruskal1958] emphasized $\tau$’s place within a broader family of nonparametric statistics for ordinal data, within the framework of formal hypothesis testing.  -->

<!-- Rank-based measures then spread to time series, enabling tests for persistence/independence in various settings [@ElShaarawi1992; @Hamed2011]. -->

<!-- And now, we apply these methods (use Kendall’s $\tau$) for the purposes of robust, distribution-free procedures, assessing both how and under what circumstances these tests of independence may be applied (e.g., whether the type of data or problem would lend itself to such an application) [@Shi2024; @Han2025]. -->

<!-- # Why This, and Why Now?  -->

<!-- Modern work continues to exploit distribution-free, rank-based tests of independence: -->

<!-- Adaptive high-dimensional tests building on Kendall’s $\tau$ [@Shi2024; @Han2025]. -->

<!-- Time-series applications echoing Fechner’s focus [@ElShaarawi1992]. -->

<!-- Broader treatments of ordinal association and nonparametric effects [@Kruskal1958; @Newson]. -->

<!-- Persistence testing with ranks in environmental contexts [@Hamed2011]. -->

# In Detail: Shi et al. (2024): Problem Statement

Let $X = (X_1, \ldots, X_d)$ be a continuous random vector, with i.i.d. observations $x_i$. 

$$
H_0: X_1, \dots, X_d \text{ are mutually independent}
$$

Testing full independence in **high dimensions** ($d \gg n$), where both *dense* and *sparse* alternatives may occur.

# Why Kendall’s $\tau$?

-   Rank-based, distribution-free, and robust to heavy tails.\
-   Each $\tau_{k\ell}$ measures pairwise monotonic dependence between $X_k, X_\ell$.
-   Works even when moments (e.g., variances) are infinite.\
-   Avoids dependence on the data-generation process (no parametric assumptions!)\
-   Only requires continuous marginals to avoid ties.

<!-- # How Is This Non-Parametric? -->

<!-- -   We make no distributional assumptions of the variables (covariates or otherwise) we wish to test for independence. -->
<!-- -   Doesn't mean the statistic (Kendall $\tau$) is distribution-free though! Just the inputs going into it! -->

# Dense vs. Sparse Settings

| Setting    | Dependence Structure    | Suitable Statistic         |
|:-----------|:------------------------|:---------------------------|
| **Dense**  | Many weak correlations  | $L_2$-type (sum-type)      |
| **Sparse** | Few strong correlations | $L_\infty$-type (max-type) |

# Method (Overview) I

1.  Compute pairwise Kendall’s taus $\tau_{k\ell}$.\
2.  Construct two base statistics:

-   $S_\tau$ ($L_2$-type):

$$
S_\tau = \omega_2^{-1/2}\left(\sum_{k>\ell}\tau_{k\ell}^2 - \frac{d(d-1)}{2}\,\omega_1\right),
\qquad
S_\tau \xrightarrow{d} N(0,1).
$$

# Method (Overview) II

-   $M_\tau$ ($L_\infty$-type):

$$
M_{\tau}
= \omega_1^{-1}\!\left( \max_{k < \ell} \tau_{k\ell}^2 \right)
\;-\; 4 \ln d \;+\; \ln \ln d, 
\qquad
M_\tau \xrightarrow{d} \text{Gumbel}.
$$

where $\omega_1, \omega_2$ are constants reflecting the variance structure of pairwise Kendall's $\tau$ under independence ($H_0$), specifically: 

$$
\omega_1 = \frac{2(2n+5)}{9n(n-1)}, \qquad
\omega_2 = \frac{4d(d-1)(n-2)(100n^3 + 492n^2 + 731n + 279)}{2025\,n^3(n-1)^3}
$$

Note: The use of "ln ln" is correct, both in the original paper and the paper it cites.

# Method (Overview) III

3.  Combine the two via the *minimum p-value approach* (an "adaptive test"):

$$
C_\tau = \min\{1 - F(M_\tau),\, 1 - \Phi(S_\tau)\},
$$

where $\Phi$ is the standard normal CDF and $F$ is the Gumbel CDF.

# A Quick Aside

What is an Adaptive Test?

-   A single procedure that automatically adapts to the dependence pattern.\
-   If data are dense, $S_\tau$ dominates; if sparse, $M_\tau$ dominates.\
-   $C_\tau$ effectively selects the stronger signal through $p\text{-value} = \min(p_{S_\tau}, p_{M_\tau})$.

# Theoretical Results I

With the following base assumptions:

-   $X = (X_1,\dots,X_d)$ has continuous marginals.
-   Observations $x_{\cdot,i}$ are i.i.d.
-   $\ln d = o(n^{1/3})$ as $n \to \infty$.

Then, under $H_0$:

-   $S_\tau$ and $M_\tau$ are **asymptotically independent**
-   Therefore,

$$
(S_\tau, M_\tau) \xrightarrow{d} (Z_1, Z_2)
\quad \text{with } Z_1\sim N(0,1),\; Z_2\sim \text{Gumbel}.
$$

# Theoretical Results II

Consequently, under $H_0$:

$$
C_\tau=\min\{1-\Phi(S_\tau),\,1-F(M_\tau)\}
\, \xrightarrow{d} \, 
W=\min(U_1,U_2)
$$

where $U_1,U_2\sim\text{Unif}(0,1)$

The limiting CDF of $W$ is

$$
H(t)=\Pr(W\le t)=2t - t^2,\qquad t\in[0,1]
$$

**Decision rule:** Reject $H_0$ if

$$
C_\tau < 1-\sqrt{\,1-\alpha\,}
$$

# Practical Implementation

-   Two variants:
    -   $TC_\tau$: Uses theoretical (asymptotic) critical values.\
    -   $MC_\tau$: Uses Monte Carlo–simulated critical values (finite-sample accurate).\
-   Distribution-free; efficient table lookup possible for $(n,d)$.

# Key Properties of the Adaptive Test

-   Adaptive: Unified test for both dense and sparse dependence.\
-   Joint Asymptotic independence of $S_{\tau}, M_{\tau}$ allows for an adaptive combination (hence the valid statistical test of independence)
-   Asymptotic theory:
    -   $S_\tau \to N(0,1)$\
    -   $M_\tau \to \text{Gumbel}$\
    -   $S_\tau, M_\tau$ independent\
    -   $C_\tau \to W$ with $H(t) = 2t - t^2$

# Results I

Under various settings, we compare the following methods:

-   $S_r$: Pearson–correlation $L_2$-type test; best for *dense dependence*.

-   $TS_{\tau}$: Kendall’s tau $L_2$-type test using *asymptotic* critical values.

-   $MS_{\tau}$: Same as $TS_{\tau}$ but with *Monte Carlo* critical values.

-   $M_r$: Pearson–correlation $L_{\infty}$-type test; best for *sparse dependence*.

-   $TM_{\tau}$: Kendall’s tau $L_{\infty}$-type test using *asymptotic* Gumbel limits.

-   $MM_{\tau}$: Same as $TM_{\tau}$ but with *Monte Carlo* critical values.

-   $TC_{\tau}$: *Adaptive* Kendall’s tau test combining $S_{\tau}$ and $M_{\tau}$ (asymptotic).

-   $MC_{\tau}$: *Adaptive* Kendall’s tau test combining $S_{\tau}$ and $M_{\tau}$ (Monte Carlo).

-   $PE_r$: *Power-enhanced* Pearson test improving $S_r$ under sparse cases.

-   $U_{\min}$: *Adaptive U-statistic* test combining multiple orders via minimum p-value.

# Results II

There are a number of tables for the various conditions the authors evaluated the statistical tests. The main focus is on the *Size* and *Power* (mainly the latter) of the statistical tests.

Overall:

-   While one particular non-adaptive test may do best under a particular setting (dense/sparse),
-   Both implementations of the adaptive test perform about as well as the "best" method in each scenario, but across **both** dense and sparse settings.
-   Highlighted portions of the tables that follow are the adaptive tests

# Results III

```{r Table 1, echo=FALSE, fig.align="center", out.height="77%", out.width="80%", fig.cap="Empirical sizes of tests (small is good)"}
knitr::include_graphics("C:/Users/samue/OneDrive/Desktop/Iowa_State_PS/STAT 5460/Report/Figures/Table1H.png")
```

# Results IV

```{r Table 2, echo=FALSE, fig.align="center", out.width="80%", fig.cap="Empirical powers of tests in dense cases."}
knitr::include_graphics("C:/Users/samue/OneDrive/Desktop/Iowa_State_PS/STAT 5460/Report/Figures/Table2H.png")
```

# Results V

```{r Table 3, echo=FALSE, fig.align="center", out.width="80%", fig.cap="Empirical powers of tests in sparse cases."}
knitr::include_graphics("C:/Users/samue/OneDrive/Desktop/Iowa_State_PS/STAT 5460/Report/Figures/Table3H.png")
```

# Results VI

```{r Table 4, echo=FALSE, fig.align="center", out.height="77%", out.width="80%", fig.cap="Empirical powers under various strengths of dependence in dense cases."}
knitr::include_graphics("C:/Users/samue/OneDrive/Desktop/Iowa_State_PS/STAT 5460/Report/Figures/Table4H.png")
```

# Results VII

```{r Table 5, echo=FALSE, fig.align="center", out.width="80%", fig.cap="Empirical powers under various strengths of dependence in sparse cases."}
knitr::include_graphics("C:/Users/samue/OneDrive/Desktop/Iowa_State_PS/STAT 5460/Report/Figures/Table5H.png")
```

# Applications

-   The paper also applies the method to two "real-world" examples:
    -   **Welding (4 vars, n=40):** Rank-based rejects null hypothesis; Pearson fails to reject.
    -   **Biochemical (8 vars, n=12):** Adaptive test detects group differences.
-   I also implemented the method myself (and validated it against the authors’ implementation).
    -   Applied (mainly for fun) to a Consulting Case
    -   A priori believed the covariate to be independent, and they were (at least according to the adaptive test)!

# Conclusion

-   Kendall’s $\tau$ connects classic nonparametric tests to modern high-dimension inference.
-   Rank-based adaptive tests are practical and robust; 2025 work generalizes to sum-of-powers [@Han2025].
-   We should consider this test when we know we have high-dimensional data, but don't know whether it is dense or sparse.
-   Allows us to test for independence beyond the typical "data collection assessment" and "variable relations graphs"

# References {.allowframebreaks}

\scriptsize
